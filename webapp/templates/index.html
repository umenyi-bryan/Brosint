<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BROsint — Neon OSINT</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body class="bg-[#03030a] text-[#c7fff0]">
  <div class="max-w-5xl mx-auto p-6">
    <pre class="text-cyan-300 text-center text-sm font-mono p-2">
██████╗ ██████╗  ██████╗ ███████╗██╗███╗   ██╗████████╗
██╔══██╗██╔══██╗██╔═══██╗██╔════╝██║████╗  ██║╚══██╔══╝
██████╔╝██████╔╝██║   ██║███████╗██║██╔██╗ ██║   ██║
██╔═══╝ ██╔══██╗██║   ██║╚════██║██║██║╚██╗██║   ██║
██║     ██║  ██║╚██████╔╝███████║██║██║ ╚████║   ██║
╚═╝     ╚═╝  ╚═╝ ╚═════╝ ╚══════╝╚═╝╚═╝  ╚══╝   ╚═╝
    BROsint — Bright Responsible OSINT  • Author: Chinedu
    </pre>

    <div class="bg-[#071018] rounded-xl p-6 shadow-lg border border-cyan-600">
      <div class="flex flex-wrap gap-3 items-center">
        <input id="email" placeholder="email@example.com" class="p-3 rounded bg-[#05060a] flex-1"/>
        <input id="phone" placeholder="+123456789" class="p-3 rounded bg-[#05060a] w-56"/>
        <input id="username" placeholder="username" class="p-3 rounded bg-[#05060a] w-56"/>
        <input id="domain" placeholder="example.com" class="p-3 rounded bg-[#05060a] w-56"/>
        <input id="fileInput" type="file" class="p-2 bg-[#05060a] rounded"/>
        <button id="uploadBtn" class="px-4 py-2 bg-cyan-400 text-black font-bold rounded">Upload</button>
        <button id="scanBtn" class="px-4 py-2 bg-violet-500 font-bold rounded">Scan</button>
      </div>

      <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="card bg-[#081018] border border-cyan-700 rounded p-4">
          <h3 class="text-cyan-300 font-semibold">Live Search</h3>
          <input id="liveQuery" placeholder="site:linkedin.com chinedu" class="mt-2 p-2 rounded w-full bg-[#05060a]"/>
          <div class="flex gap-2 mt-2">
            <button id="goSearch" class="px-3 py-2 bg-cyan-400 rounded font-bold text-black">Run</button>
          </div>
          <pre id="searchOut" class="mt-2 text-sm overflow-auto"></pre>
        </div>

        <div class="card bg-[#081018] border border-cyan-700 rounded p-4">
          <h3 class="text-cyan-300 font-semibold">Last Report</h3>
          <pre id="reportArea" class="mt-2 text-sm overflow-auto">{{ report | tojson(indent=2) }}</pre>
        </div>
      </div>

      <div class="mt-4">
        <h3 class="text-cyan-300 font-semibold">Output</h3>
        <div id="cards" class="mt-2 grid gap-4"></div>
      </div>
    </div>
  </div>

<script>
const uploadBtn = document.getElementById('uploadBtn');
const scanBtn = document.getElementById('scanBtn');
const goSearch = document.getElementById('goSearch');

function makeCard(title, obj){
  const el = document.createElement('div');
  el.className = "p-3 bg-[#050718] rounded border border-cyan-500";
  el.innerHTML = `<strong class="text-cyan-200">${title}</strong><pre class="mt-2 text-sm">${JSON.stringify(obj,null,2)}</pre>`;
  return el;
}

uploadBtn.onclick = async () => {
  const f = document.getElementById('fileInput').files[0];
  if(!f) return alert('Select a file to upload');
  const form = new FormData();
  form.append('file', f);
  const res = await fetch('/api/upload', {method:'POST', body: form});
  const j = await res.json();
  if(j.path){
    alert('Uploaded: ' + j.filename);
    // set file path input to server path for scan
    // store temp in a data attribute
    uploadBtn.dataset.path = j.path;
  } else {
    alert('Upload failed');
  }
};

scanBtn.onclick = async () => {
  const payload = {
    email: document.getElementById('email').value || null,
    phone: document.getElementById('phone').value || null,
    username: document.getElementById('username').value || null,
    domain: document.getElementById('domain').value || null,
    file: uploadBtn.dataset.path || null
  };
  const resp = await fetch('/api/scan', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
  const data = await resp.json();
  document.getElementById('reportArea').textContent = JSON.stringify(data,null,2);
  const cards = document.getElementById('cards'); cards.innerHTML='';
  for(const k of Object.keys(data)){ cards.appendChild(makeCard(k, data[k])); }
};

goSearch.onclick = async () => {
  const q = document.getElementById('liveQuery').value.trim();
  if(!q) return alert('Enter a query');
  const resp = await fetch('/api/search', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({query:q})});
  const j = await resp.json();
  document.getElementById('searchOut').textContent = JSON.stringify(j,null,2);
};
</script>
</body>
</html>
